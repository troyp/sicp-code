#reader(lib"read.ss""wxme")WXME0108 ## 
#|
   This file is in PLT Scheme editor format.
   Open this file in DrScheme version 370 or later to read it.

   Most likely, it was created by saving a program in DrScheme,
   and it probably contains a program with non-text elements
   (such as images or comment boxes).

            http://www.plt-scheme.org
|#
 29 7 #"wxtext\0"
3 1 6 #"wxtab\0"
1 1 8 #"wxmedia\0"
4 1 8 #"wximage\0"
2 0 34 #"(lib \"syntax-browser.ss\" \"mrlib\")\0"
1 0 16 #"drscheme:number\0"
3 0 44 #"(lib \"number-snip.ss\" \"drscheme\" \"private\")\0"
1 0 36 #"(lib \"comment-snip.ss\" \"framework\")\0"
1 0 43 #"(lib \"collapsed-snipclass.ss\" \"framework\")\0"
0 0 19 #"drscheme:sexp-snip\0"
0 0 36 #"(lib \"cache-image-snip.ss\" \"mrlib\")\0"
1 0 33 #"(lib \"bullet-snip.ss\" \"browser\")\0"
0 0 29 #"drscheme:bindings-snipclass%\0"
1 0 25 #"(lib \"matrix.ss\" \"htdp\")\0"
1 0 22 #"drscheme:lambda-snip%\0"
1 0 56
(
 #"(lib \"hrule-snip.ss\" \"macro-debugger\" \"syntax-browse"
 #"r\")\0"
) 1 0 18 #"java-comment-box%\0"
1 0 23 #"java-interactions-box%\0"
1 0 45 #"(lib \"image-snipr.ss\" \"slideshow\" \"private\")\0"
1 0 26 #"drscheme:pict-value-snip%\0"
0 0 38 #"(lib \"pict-snipclass.ss\" \"slideshow\")\0"
2 0 55
(
 #"(lib \"vertical-separator-snip.ss\" \"stepper\" \"private"
 #"\")\0"
) 1 0 18 #"drscheme:xml-snip\0"
1 0 31 #"(lib \"xml-snipclass.ss\" \"xml\")\0"
1 0 21 #"drscheme:scheme-snip\0"
2 0 34 #"(lib \"scheme-snipclass.ss\" \"xml\")\0"
1 0 10 #"text-box%\0"
1 0 32 #"(lib \"text-snipclass.ss\" \"xml\")\0"
1 0 15 #"test-case-box%\0"
2 0 1 6 #"wxloc\0"
00000000000 1 55 0 1 #"\0"
0 75 1 #"\0"
0 10 90 -1 90 -1 3 -1 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 255 255 255 1 -1 0 9
#"Standard\0"
0 75 23 #"Droid Sans Mono Dotted\0"
0 12 90 -1 90 -1 3 -1 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 255 255 255 1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0 0 -1 -1 2 24
#"framework:default-color\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 150 0 150 0 0 0 -1 -1 2 15
#"text:ports out\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 150 0 150 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 93 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 255 0 0 0 0 0 -1 -1 2 15
#"text:ports err\0"
0 -1 1 #"\0"
1 0 -1 -1 93 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 255 0 0 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 0 0 175 0 0 0 -1 -1 2 17
#"text:ports value\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 0 0 175 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 92 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 34 139 34 0 0 0 -1 -1 2 27
#"Matching Parenthesis Style\0"
0 -1 1 #"\0"
1 0 92 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 34 139 34 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 38 38 128 0 0 0 -1 -1 2 37
#"framework:syntax-color:scheme:symbol\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 38 38 128 0 0 0 -1 -1 2 38
#"framework:syntax-color:scheme:keyword\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 38 38 128 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 194 116 31 0 0 0 -1 -1 2
38 #"framework:syntax-color:scheme:comment\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 194 116 31 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 41 128 38 0 0 0 -1 -1 2 37
#"framework:syntax-color:scheme:string\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 41 128 38 0 0 0 -1 -1 2 39
#"framework:syntax-color:scheme:constant\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 41 128 38 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 132 60 36 0 0 0 -1 -1 2 42
#"framework:syntax-color:scheme:parenthesis\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 132 60 36 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 255 0 0 0 0 0 -1 -1 2 36
#"framework:syntax-color:scheme:error\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 255 0 0 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 -1 -1 2 36
#"framework:syntax-color:scheme:other\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 81 112 203 0 0 0 -1 -1 2
38 #"drscheme:check-syntax:lexically-bound\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 81 112 203 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 68 0 203 0 0 0 -1 -1 2 31
#"drscheme:check-syntax:imported\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 68 0 203 0 0 0 -1 -1 2 41
#"profj:syntax-colors:scheme:block-comment\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 194 116 31 0 0 0 -1 -1 2
35 #"profj:syntax-colors:scheme:keyword\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 139 0 139 0 0 0 -1 -1 2 37
#"profj:syntax-colors:scheme:prim-type\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 139 0 139 0 0 0 -1 -1 2 38
#"profj:syntax-colors:scheme:identifier\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 38 38 128 0 0 0 -1 -1 2 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 34 139 34 0 0 0 -1 -1 2 34
#"profj:syntax-colors:scheme:string\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 34 139 34 0 0 0 -1 -1 2 35
#"profj:syntax-colors:scheme:literal\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 34 139 34 0 0 0 -1 -1 2 35
#"profj:syntax-colors:scheme:comment\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 194 116 31 0 0 0 -1 -1 2
33 #"profj:syntax-colors:scheme:error\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 255 0 0 0 0 0 -1 -1 2 35
#"profj:syntax-colors:scheme:default\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 -1 -1 2 37
#"profj:syntax-colors:scheme:uncovered\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 -1 -1 2 35
#"profj:syntax-colors:scheme:covered\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 139 0 139 0 0 0 -1 -1 4 1
#"\0"
0 70 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0 0 -1 -1 4 4
#"XML\0"
0 70 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0 0 -1 -1 8 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 255 0 0 0 0 0 -1 -1 8 24
#"drscheme:text:ports err\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 255 0 0 0 0 0 -1 -1 4 1
#"\0"
0 71 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0 0 -1 -1 4 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 1 0 0 0 0 0 0 0 0 1 1 1 0 0 255 0 0 0 -1 -1 4 1
#"\0"
0 71 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 1 0 0 0 0 0 0 0 0 1 1 1 0 0 255 0 0 0 -1 -1 4 1
#"\0"
0 71 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 0 100 0 0 0 0 -1 -1 4 1
#"\0"
0 -1 1 #"\0"
1 0 92 -1 -1 -1 -1 -1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 255 255 0 -1 -1 0 1
#"\0"
0 75 23 #"Droid Sans Mono Dotted\0"
0 12 90 -1 90 -1 3 -1 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 255 255 255 1 -1 0 1
#"\0"
0 -1 1 #"\0"
1 0 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 1 1 1 200 0 0 0 0 0 -1 -1
00000000001 0 00000000000 6036 0 26 3 12 #"#lang scheme"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 74
(
 #";;-----------------------------------------------------------------"
 #"-------"
) 0 0 4 29 1 #"\n"
0 0 17 3 16 #";; utility procs"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"error"
0 0 4 3 1 #" "
0 0 14 3 1 #"s"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"display"
0 0 4 3 1 #" "
0 0 19 3 9 #"\"error: \""
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"display"
0 0 4 3 1 #" "
0 0 14 3 1 #"s"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"display"
0 0 4 3 1 #" "
0 0 19 3 3 #"\" \""
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"display"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"square"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 14 3 2 #"pi"
0 0 4 3 1 #" "
0 0 20 3 7 #"3.14159"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 2 #"id"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 17 3 28 #";; TODO: This is buggy - FIX"
0 0 4 29 1 #"\n"
0 0 17 3 95
(
 #";; (find-elem (lambda (x) (not (pair? (car x)))) '(({2 3} 5) ((3)) "
 #"(9 (6 5)) 3))   => (9 (6 5))"
) 0 0 4 29 1 #"\n"
0 0 17 3 91
(
 #";; (find-elem (lambda (x) (not (pair? (car x)))) '(({2 3} 5) ((3)) "
 #". (9 (6 5))))   => error"
) 0 0 4 29 1 #"\n"
0 0 17 3 94
(
 #";; \"car: expects argument of type <pair>; given 9\".  Note: im"
 #"proper list ok with int elements."
) 0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"find-elem"
0 0 4 3 1 #" "
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"not"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"pair?"
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"error"
0 0 4 3 1 #" "
0 0 19 3 11 #"\"not pair.\""
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"null?"
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 3 #"fst"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 12 #"            "
0 0 22 3 1 #"("
0 0 14 3 3 #"snd"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"cdr"
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 3 #"fst"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 3 #"fst"
0 0 4 29 1 #"\n"
0 0 4 3 12 #"            "
0 0 22 3 1 #"("
0 0 15 3 4 #"cond"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 5 #"pair?"
0 0 4 3 1 #" "
0 0 14 3 3 #"snd"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"find-elem"
0 0 4 3 1 #" "
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 3 #"snd"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 18 #"                  "
0 0 22 3 2 #"(("
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 3 #"snd"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 3 #"snd"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 18 #"                  "
0 0 22 3 1 #"("
0 0 14 3 4 #"else"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 22 3 7 #")))))))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"inq?"
0 0 4 3 1 #" "
0 0 14 3 4 #"elem"
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"null?"
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"eq?"
0 0 4 3 1 #" "
0 0 14 3 4 #"elem"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 20 3 2 #"#t"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 4 #"inq?"
0 0 4 3 1 #" "
0 0 14 3 4 #"elem"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"cdr"
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 17 3 72
(
 #";;-----------------------------------------------------------------"
 #"-----"
) 0 0 4 29 1 #"\n"
0 0 17 3 57 #";; Type Tag constructor & selectors (replaced in ex 2.78)"
0 0 4 29 1 #"\n"
0 0 17 3 65
#";(define (attach-tag type-tag contents) (cons type-tag contents))"
0 0 4 29 1 #"\n"
0 0 17 3 25 #";(define (type-tag datum)"
0 0 4 29 1 #"\n"
0 0 17 3 20 #";  (if (pair? datum)"
0 0 4 29 1 #"\n"
0 0 17 3 18 #";      (car datum)"
0 0 4 29 1 #"\n"
0 0 17 3 53 #";      (error \"Bad tagged datum -- TYPE-TAG\" datum)))"
0 0 4 29 1 #"\n"
0 0 17 3 25 #";(define (contents datum)"
0 0 4 29 1 #"\n"
0 0 17 3 20 #";  (if (pair? datum)"
0 0 4 29 1 #"\n"
0 0 17 3 18 #";      (cdr datum)"
0 0 4 29 1 #"\n"
0 0 17 3 53 #";      (error \"Bad tagged datum -- CONTENTS\" datum)))"
0 0 4 29 1 #"\n"
0 0 17 3 71
(
 #";;-----------------------------------------------------------------"
 #"----"
) 0 0 4 29 1 #"\n"
0 0 17 3 71
(
 #";; quick-and-dirty list implementation of put and get using global "
 #"\"db\""
) 0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 14 3 2 #"db"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 3 #"())"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"generic-procs"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 2 #"db"
0 0 22 3 1 #")"
0 0 4 3 2 #"  "
0 0 17 3 54 #"; returns the generic procedure table in the form of a"
0 0 4 29 1 #"\n"
0 0 17 3 84
(
 #";; list of entries. The procs get-name, etc, can be used on an entr"
 #"y to extract info"
) 0 0 4 29 1 #"\n"
0 0 17 3 52 #";; accessors for accsesing the fields of an entry..."
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"get-name"
0 0 4 3 1 #" "
0 0 14 3 7 #"listof3"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 7 #"listof3"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"get-type"
0 0 4 3 1 #" "
0 0 14 3 7 #"listof3"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cadr"
0 0 4 3 1 #" "
0 0 14 3 7 #"listof3"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"get-proc"
0 0 4 3 1 #" "
0 0 14 3 7 #"listof3"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"caddr"
0 0 4 3 1 #" "
0 0 14 3 7 #"listof3"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 4 3 1 #" "
0 0 14 3 4 #"item"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 4 #"set!"
0 0 4 3 1 #" "
0 0 14 3 2 #"db"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"list"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 4 3 1 #" "
0 0 14 3 4 #"item"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 2 #"db"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 4 #"elem"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 3 #"and"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"equal?"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"get-name"
0 0 4 3 1 #" "
0 0 14 3 4 #"elem"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 14 3 6 #"equal?"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"get-type"
0 0 4 3 1 #" "
0 0 14 3 4 #"elem"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 7 #"matches"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"filter"
0 0 4 3 1 #" "
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 2 #"db"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"null?"
0 0 4 3 1 #" "
0 0 14 3 7 #"matches"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 20 3 2 #"#f"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 15 3 5 #"match"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 7 #"matches"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 10 #"          "
0 0 22 3 1 #"("
0 0 14 3 5 #"caddr"
0 0 4 3 1 #" "
0 0 15 3 5 #"match"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 72
(
 #";;-----------------------------------------------------------------"
 #"-----"
) 0 0 4 29 1 #"\n"
0 0 17 3 16 #";; apply-generic"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 18 #"apply-generic-ORIG"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 26 3 1 #"."
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 1 #")"
0 0 4 3 4 #"    "
0 0 17 3 42 #"; new apply-generic: see below, \"Coercion\""
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 4 #"let*"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 9 #"type-tags"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"map"
0 0 4 3 1 #" "
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 14 3 4 #"proc"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 14 3 9 #"type-tags"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 14 3 4 #"proc"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 5 #"apply"
0 0 4 3 1 #" "
0 0 14 3 4 #"proc"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"map"
0 0 4 3 1 #" "
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 5 #"error"
0 0 4 3 1 #" "
0 0 19 3 44 #"\"No method for these types -- APPLY GENERIC\""
0 0 4 29 1 #"\n"
0 0 4 3 15 #"               "
0 0 22 3 1 #"("
0 0 14 3 4 #"list"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 14 3 9 #"type-tags"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 17 3 71
(
 #";;-----------------------------------------------------------------"
 #"----"
) 0 0 4 29 1 #"\n"
0 0 17 3 33 #";; rectangular and polar packages"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 27 #"install-rectangular-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 17 3 17 #";; internal procs"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"cdr"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"sqrt"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"+"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"square"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"square"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"atan"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"cos"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"sin"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 17 3 38 #";; interface to the rest of the system"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"attach-tag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 11 #"rectangular"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 11 #"rectangular"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 9 #"real-part"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 11 #"rectangular"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 9 #"imag-part"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 11 #"rectangular"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 9 #"magnitude"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 11 #"rectangular"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 5 #"angle"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 11 #"rectangular"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 11 #"rectangular"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 20 3 1 #"'"
0 0 14 3 4 #"done"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 21 #"install-polar-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 17 3 17 #";; internal procs"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"cdr"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 15 3 4 #"cond"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 5 #"zero?"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 20 3 1 #"0"
0 0 4 3 1 #" "
0 0 20 3 1 #"0"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 10 #"          "
0 0 22 3 2 #"(("
0 0 14 3 2 #"<="
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"-"
0 0 4 3 1 #" "
0 0 14 3 2 #"pi"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"+"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 20 3 1 #"2"
0 0 4 3 1 #" "
0 0 14 3 2 #"pi"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 10 #"          "
0 0 22 3 2 #"(("
0 0 14 3 1 #">"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 4 3 1 #" "
0 0 14 3 2 #"pi"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"-"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 20 3 1 #"2"
0 0 4 3 1 #" "
0 0 14 3 2 #"pi"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 10 #"          "
0 0 22 3 1 #"("
0 0 14 3 4 #"else"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"cos"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"sin"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"sqrt"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"+"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"square"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"square"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 3 #")))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"atan"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 17 3 38 #";; interface to the reat of the system"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"attach-tag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"polar"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 5 #"polar"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 9 #"real-part"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 5 #"polar"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 9 #"imag-part"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 5 #"polar"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 9 #"magnitude"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 5 #"polar"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 5 #"angle"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"polar"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"polar"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 20 3 1 #"'"
0 0 14 3 4 #"done"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 17 3 62
#";; -----------------------------------------------------------"
0 0 4 29 1 #"\n"
0 0 17 3 40 #";; Generic selectors for complex numbers"
0 0 4 29 1 #"\n"
0 0 17 3 64
#";; NOTE: these override builtin procs for primitive complex type"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 17 3 65
#";; Generic constructors for rectangular and polar representations"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 2 #"(("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 11 #"rectangular"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 2 #"(("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"polar"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 17 3 63
#";; ------------------------------------------------------------"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 48 #";; *********************************************"
0 0 4 29 1 #"\n"
0 0 17 3 48 #";; *                                           *"
0 0 4 29 1 #"\n"
0 0 17 3 48 #";; *  CH 2.5: SYSTEMS WITH GENERIC OPERATIONS  *"
0 0 4 29 1 #"\n"
0 0 17 3 48 #";; *                                           *"
0 0 4 29 1 #"\n"
0 0 17 3 48 #";; *********************************************"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 66
#";; We will design a generic arithmetic system capable of operating"
0 0 4 29 1 #"\n"
0 0 17 3 65
#";; on different types using additive packages. Any given type may"
0 0 4 29 1 #"\n"
0 0 17 3 67
#";; itself be accessed by generic procedures that dispatch according"
0 0 4 29 1 #"\n"
0 0 17 3 20 #";; to representation"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 63
#";; We implement the generic arithmetic operators using the same"
0 0 4 29 1 #"\n"
0 0 17 3 68
#";; strategy we used for generic selectors for complex numbers: we'll"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; attach a type-tag to each kind of number and have the generic proc"
0 0 4 29 1 #"\n"
0 0 17 3 51 #";; dispatch according to the data type or its args."
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"add"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"add"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"sub"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"sub"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"mul"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"mul"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"div"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"div"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 68
#";; We first install a package for dealing with ordinary numbers, ie."
0 0 4 29 1 #"\n"
0 0 17 3 62
#";; the primitive numbers of the language. We'll tag these with"
0 0 4 29 1 #"\n"
0 0 17 3 70
(
 #";; 'scheme-number and dispatch to the primitive aritmetic procs. Si"
 #"nce"
) 0 0 4 29 1 #"\n"
0 0 17 3 69
#";; each op takes 2 args, they are installed in the table keyed by the"
0 0 4 29 1 #"\n"
0 0 17 3 37 #";; list (scheme-number scheme-number)"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 29 #"install-scheme-number-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"attach-tag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 13 #"scheme-number"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"add"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 13 #"scheme-number"
0 0 4 3 1 #" "
0 0 14 3 13 #"scheme-number"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"+"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"sub"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 13 #"scheme-number"
0 0 4 3 1 #" "
0 0 14 3 13 #"scheme-number"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"-"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"mul"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 13 #"scheme-number"
0 0 4 3 1 #" "
0 0 14 3 13 #"scheme-number"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"div"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 13 #"scheme-number"
0 0 4 3 1 #" "
0 0 14 3 13 #"scheme-number"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"/"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 4 #"make"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 13 #"scheme-number"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 20 3 1 #"'"
0 0 14 3 4 #"done"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 17 3 67
#";; Users of the scheme-number package will create (tagged) ordinary"
0 0 4 29 1 #"\n"
0 0 17 3 27 #";; numbers with the proc..."
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 18 #"make-scheme-number"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 2 #"(("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 4 #"make"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 13 #"scheme-number"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; With the framework in place, we can add new kinds of numbers. Here"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; is a rationals package. Note: thanks to additivity, we can use our"
0 0 4 29 1 #"\n"
0 0 17 3 48 #";; previous rational code as the internal procs."
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 24 #"install-rational-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 17 3 17 #";; internal procs"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"cdr"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"make-rat"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"d"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 1 #"g"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"gcd"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"d"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"/"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"g"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"/"
0 0 4 3 1 #" "
0 0 14 3 1 #"d"
0 0 4 3 1 #" "
0 0 14 3 1 #"g"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"add-rat"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 8 #"make-rat"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"+"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 14 #"              "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"sub-rat"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 8 #"make-rat"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"-"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 14 #"              "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"mul-rat"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 8 #"make-rat"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"div-rat"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 8 #"make-rat"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 17 3 12 #";; interface"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"attach-tag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 8 #"rational"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"add"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 8 #"rational"
0 0 4 3 1 #" "
0 0 14 3 8 #"rational"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"add-rat"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"sub"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 8 #"rational"
0 0 4 3 1 #" "
0 0 14 3 8 #"rational"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"sub-rat"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"mul"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 8 #"rational"
0 0 4 3 1 #" "
0 0 14 3 8 #"rational"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"mul-rat"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"div"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 8 #"rational"
0 0 4 3 1 #" "
0 0 14 3 8 #"rational"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"div-rat"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 4 #"make"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 8 #"rational"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"d"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"make-rat"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"d"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 20 3 1 #"'"
0 0 14 3 4 #"done"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"make-rational"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"d"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 2 #"(("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 4 #"make"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 8 #"rational"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"d"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 68
#";; We can install a package for complex numbers, extracting from the"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; table the ops make-from-real-imag and make-from-mag-ang, that were"
0 0 4 29 1 #"\n"
0 0 17 3 67
#";; defined by the rectangular and polar packages. Additivity allows"
0 0 4 29 1 #"\n"
0 0 17 3 47 #";; us to use the same internal ops from sect2.4"
0 0 4 29 1 #"\n"
0 0 17 3 64
#";; Since the complex package uses rectangular and polar procs as"
0 0 4 29 1 #"\n"
0 0 17 3 72
(
 #";; convenient, both packages are required to support the arithmetic"
 #" ops."
) 0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 23 #"install-complex-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 17 3 46 #";; imported procs from rect and polar packages"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 2 #"(("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 11 #"rectangular"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 2 #"(("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"polar"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 17 3 22 #";; internal procedures"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"add-complex"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"+"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 25 #"                         "
0 0 22 3 1 #"("
0 0 14 3 1 #"+"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"sub-complex"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"-"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 25 #"                         "
0 0 22 3 1 #"("
0 0 14 3 1 #"-"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"mul-complex"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 23 #"                       "
0 0 22 3 1 #"("
0 0 14 3 1 #"+"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"div-complex"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"/"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 23 #"                       "
0 0 22 3 1 #"("
0 0 14 3 1 #"-"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 17 3 12 #";; interface"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"attach-tag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"complex"
0 0 4 3 1 #" "
0 0 14 3 1 #"z"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"add"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"complex"
0 0 4 3 1 #" "
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"add-complex"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"sub"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"complex"
0 0 4 3 1 #" "
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"sub-complex"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"mul"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"complex"
0 0 4 3 1 #" "
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"mul-complex"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"div"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"complex"
0 0 4 3 1 #" "
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"div-complex"
0 0 4 3 1 #" "
0 0 14 3 2 #"z1"
0 0 4 3 1 #" "
0 0 14 3 2 #"z2"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"complex"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"complex"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 17 #"make-from-mag-ang"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"real-part"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 9 #"real-part"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"imag-part"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 9 #"imag-part"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 9 #"magnitude"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"angle"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 5 #"angle"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 20 3 1 #"'"
0 0 14 3 4 #"done"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 27 #"make-complex-from-real-imag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 2 #"(("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 27 #"make-complex-from-mag-angle"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 2 #"(("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 19 #"make-from-real-imag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 55 #";; We have here a 2-level tag system. A complex number,"
0 0 4 29 1 #"\n"
0 0 17 3 50 #";; say 3+4i, in rectangular form is represented by"
0 0 4 29 1 #"\n"
0 0 17 3 56 #";; '(complex rectangular 3 . 4). The outer tag (complex)"
0 0 4 29 1 #"\n"
0 0 17 3 55 #";; is used to direct the number to the complex package."
0 0 4 29 1 #"\n"
0 0 17 3 57 #";; Within the complex package, the next tag (rectangular)"
0 0 4 29 1 #"\n"
0 0 17 3 59
#";; is used to direct the number to the rectangular package."
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 4 29 1 #"\n"
0 0 17 3 56 #";; In a larger and more complicated system, there may be"
0 0 4 29 1 #"\n"
0 0 17 3 55 #";; many levels, each interfaced to the next by means of"
0 0 4 29 1 #"\n"
0 0 17 3 62
#";; generic operations. As a data object is passed \"downwards\","
0 0 4 29 1 #"\n"
0 0 17 3 57 #";; the type-tag is used to dispatch it to the appropriate"
0 0 4 29 1 #"\n"
0 0 17 3 53 #";; package. At the same time, the tag is stripped off"
0 0 4 29 1 #"\n"
0 0 17 3 56 #";; (using 'contents') and the next level of tag (if any)"
0 0 4 29 1 #"\n"
0 0 17 3 54 #";; becomes visible to be used for further dispatching."
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 55 #";; Note: while we use specific names like \"add-complex\""
0 0 4 29 1 #"\n"
0 0 17 3 57 #";; for the type-specific procs within a package, there is"
0 0 4 29 1 #"\n"
0 0 17 3 59
#";; no need to make them distinct. We could just as easy use"
0 0 4 29 1 #"\n"
0 0 17 3 54 #";; \"add\" for the addition proc in every package, since"
0 0 4 29 1 #"\n"
0 0 17 3 43 #";; these procs are internal to the package."
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 62
#";; [ex 2.77] To add a real-part operation fo the complex type,"
0 0 4 29 1 #"\n"
0 0 17 3 27 #";; all we had to do was add"
0 0 4 29 1 #"\n"
0 0 17 3 55 #";;           (put 'real-part 'complex real-part) to the"
0 0 4 29 1 #"\n"
0 0 17 3 61
#";; package. Why does this work? There was already a real-part"
0 0 4 29 1 #"\n"
0 0 17 3 61
#";; generic procedure defined: it uses the type-tag of the arg"
0 0 4 29 1 #"\n"
0 0 17 3 62
#";; to search for an appropriate 'real-part entry in the table."
0 0 4 29 1 #"\n"
0 0 17 3 62
#";; There was no such entry for complex, but there were entries"
0 0 4 29 1 #"\n"
0 0 17 3 61
#";; for 'rectangular and 'polar. A number of type complex is a"
0 0 4 29 1 #"\n"
0 0 17 3 63
#";; rectangular or polar number with a 'complex tag at the head."
0 0 4 29 1 #"\n"
0 0 17 3 56 #";; All we need do to find the real-part is strip off the"
0 0 4 29 1 #"\n"
0 0 17 3 60
#";; 'complex tag and then find the real-part of the resulting"
0 0 4 29 1 #"\n"
0 0 17 3 52 #";; rectangular or polar number. This is exactly what"
0 0 4 29 1 #"\n"
0 0 17 3 55 #";; (apply-generic real-part z) does, and therefore what"
0 0 4 29 1 #"\n"
0 0 17 3 64
#";; (real-part z) does. (real-part z) strips off the complex tag,"
0 0 4 29 1 #"\n"
0 0 17 3 64
#";; looks up the table for the type-specific op, is told to apply"
0 0 4 29 1 #"\n"
0 0 17 3 63
#";; real-part again. It then strips off the rectangular or polar"
0 0 4 29 1 #"\n"
0 0 17 3 66
#";; tag and looks up the table again, being sent to the appropriate"
0 0 4 29 1 #"\n"
0 0 17 3 38 #";; package for the specific operation."
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 63
#";; [ex 2.78] We have used scheme's primitive numbers wrapped in"
0 0 4 29 1 #"\n"
0 0 17 3 61
#";;           a type-tag. However, scheme already has internal"
0 0 4 29 1 #"\n"
0 0 17 3 62
#";;           types, which can be detected with predicates like"
0 0 4 29 1 #"\n"
0 0 17 3 65
#";;           number? and symbol?. Modify the type-tag constructor"
0 0 4 29 1 #"\n"
0 0 17 3 65
#";;           and selectors to take advantage of this, so ordinary"
0 0 4 29 1 #"\n"
0 0 17 3 67
#";;           numbers should be represented simply as scheme numbers"
0 0 4 29 1 #"\n"
0 0 17 3 50 #";;           rather than pairs (scheme-number, n)."
0 0 4 29 1 #"\n"
0 0 17 3 71
(
 #";; I'll define utils (lowest-level): put-tag, get-tag, detag, type-"
 #"obj?"
) 0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"put-tag"
0 0 4 3 1 #" "
0 0 14 3 7 #"typeTag"
0 0 4 3 1 #" "
0 0 14 3 8 #"contents"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"eq?"
0 0 4 3 1 #" "
0 0 14 3 7 #"typeTag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 13 #"scheme-number"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 14 3 8 #"contents"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 14 3 7 #"typeTag"
0 0 4 3 1 #" "
0 0 14 3 8 #"contents"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"get-tag"
0 0 4 3 1 #" "
0 0 14 3 3 #"obj"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"number?"
0 0 4 3 1 #" "
0 0 14 3 3 #"obj"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 20 3 1 #"'"
0 0 14 3 13 #"scheme-number"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 3 #"obj"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"detag"
0 0 4 3 1 #" "
0 0 14 3 3 #"obj"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"number?"
0 0 4 3 1 #" "
0 0 14 3 3 #"obj"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 14 3 3 #"obj"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 3 #"cdr"
0 0 4 3 1 #" "
0 0 14 3 3 #"obj"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"typed-obj?"
0 0 4 3 1 #" "
0 0 14 3 3 #"obj"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"or"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"number?"
0 0 4 3 1 #" "
0 0 14 3 3 #"obj"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"pair?"
0 0 4 3 1 #" "
0 0 14 3 3 #"obj"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; Now, replace cons, car, cdr and pair in the constructors/selectors"
0 0 4 29 1 #"\n"
0 0 17 3 22 #";; with these procs..."
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"attach-tag"
0 0 4 3 1 #" "
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 8 #"contents"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"put-tag"
0 0 4 3 1 #" "
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 8 #"contents"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 5 #"datum"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"typed-obj?"
0 0 4 3 1 #" "
0 0 14 3 5 #"datum"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 7 #"get-tag"
0 0 4 3 1 #" "
0 0 14 3 5 #"datum"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 5 #"error"
0 0 4 3 1 #" "
0 0 19 3 30 #"\"Bad tagged datum -- TYPE-TAG\""
0 0 4 3 1 #" "
0 0 14 3 5 #"datum"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 5 #"datum"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"typed-obj?"
0 0 4 3 1 #" "
0 0 14 3 5 #"datum"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 5 #"detag"
0 0 4 3 1 #" "
0 0 14 3 5 #"datum"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 5 #"error"
0 0 4 3 1 #" "
0 0 19 3 30 #"\"Bad tagged datum -- CONTENTS\""
0 0 4 3 1 #" "
0 0 14 3 5 #"datum"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 64
(
 #";; [ex 2.79] Define a generic equality predicate equ? that wo"
 #"rks"
) 0 0 4 29 1 #"\n"
0 0 17 3 47 #";; with ordinary, rational and complex numbers."
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"equ?"
0 0 4 3 1 #" "
0 0 14 3 4 #"num1"
0 0 4 3 1 #" "
0 0 14 3 4 #"num2"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 4 #"cond"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 2 #"or"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"number?"
0 0 4 3 1 #" "
0 0 14 3 4 #"num1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"number?"
0 0 4 3 1 #" "
0 0 14 3 4 #"num2"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"eq?"
0 0 4 3 1 #" "
0 0 14 3 4 #"num1"
0 0 4 3 1 #" "
0 0 14 3 4 #"num2"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 17 3 59
(
 #"; base case (note: \"or\" slightly more efficient than \"and"
 #"\")"
) 0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 2 #"(("
0 0 14 3 3 #"eq?"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 4 #"num1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 4 #"num2"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 14 3 4 #"equ?"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 4 #"num1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 4 #"num2"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 4 #"else"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 17 3 70
(
 #";; note: This will never judge numbers of different types to be equ"
 #"al."
) 0 0 4 29 1 #"\n"
0 0 17 3 69
#";; If we wish to judge equality of, say, different representations of"
0 0 4 29 1 #"\n"
0 0 17 3 71
(
 #";; complex numbers, we should write a predicate that uses apply-gen"
 #"eric"
) 0 0 4 29 1 #"\n"
0 0 17 3 70
(
 #";; to dispatch to type-specific versions. note: Also, this may fail"
 #" if"
) 0 0 4 29 1 #"\n"
0 0 17 3 68
#";; a type has more than one representation for the same number (eg.,"
0 0 4 29 1 #"\n"
0 0 17 3 68
#";; rational, polar). make-rat automatically puts numbers into lowest"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; form so there is no problem. We need to alter the polar package to"
0 0 4 29 1 #"\n"
0 0 17 3 67
(
 #";; make sure polar numbers are in a \"normal form\". This means"
 #" there"
) 0 0 4 29 1 #"\n"
0 0 17 3 64
#";; will be a restriction on all future number packages, that the"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; representations they generate correspond uniquely to numbers, even"
0 0 4 29 1 #"\n"
0 0 17 3 40 #";; if the input representations are not."
0 0 4 29 1 #"\n"
0 0 17 3 70
(
 #";; There is a way to lift this limitation: we could add the option "
 #"for"
) 0 0 4 29 1 #"\n"
0 0 17 3 72
(
 #";; a package to include its own equality predicate. That way, equ? "
 #"could"
) 0 0 4 29 1 #"\n"
0 0 17 3 69
#";; dispatch to the specific predicate if it exists, or otherwise fall"
0 0 4 29 1 #"\n"
0 0 17 3 62
#";; back on its default procedure. This would allow for non-1-1"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; representations. However, it doesn;t seem necessary at the moment,"
0 0 4 29 1 #"\n"
0 0 17 3 45 #";; and this option can be easily added later."
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 68
(
 #";; [ex 2.80] Define a generic predicate =zero? working for or"
 #"dinary,"
) 0 0 4 29 1 #"\n"
0 0 17 3 28 #";; rational and complex nums"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"=zero?"
0 0 4 3 1 #" "
0 0 14 3 3 #"num"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 4 #"equ?"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"add"
0 0 4 3 1 #" "
0 0 14 3 3 #"num"
0 0 4 3 1 #" "
0 0 14 3 3 #"num"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"sub"
0 0 4 3 1 #" "
0 0 14 3 3 #"num"
0 0 4 3 1 #" "
0 0 14 3 3 #"num"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; There is a problem with (equ? num (sub num num)) where subtraction"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; changes the representation of a number (eg. polar to rectangular)."
0 0 4 29 1 #"\n"
0 0 17 3 66
#";; There is a safe chance that sub and add reult in the same type."
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 37 #";; =================================="
0 0 4 29 1 #"\n"
0 0 17 3 37 #";; COMBINING DATA OF DIFFERENT TYPES."
0 0 4 29 1 #"\n"
0 0 17 3 37 #";; =================================="
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 62
#";; So far we've treated the different data types as completely"
0 0 4 29 1 #"\n"
0 0 17 3 61
#";; independent. However, it is sometimes meaningful to define"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; operations across type boundaries, eg. adding a scheme-number to a"
0 0 4 29 1 #"\n"
0 0 17 3 66
#";; complex number. One way to handle this is to design a different"
0 0 4 29 1 #"\n"
0 0 17 3 72
(
 #";; proc for each type combination and install these procs in the ta"
 #"ble ."
) 0 0 4 29 1 #"\n"
0 0 17 3 58
#";; eg we could add the following to the complex package..."
0 0 4 29 1 #"\n"
0 0 17 3 39 #";(define (add-complex-to-schemenum z x)"
0 0 4 29 1 #"\n"
0 0 17 3 43 #";  (make-from-real-imag (+ (real-part z) x)"
0 0 4 29 1 #"\n"
0 0 17 3 39 #";                       (imag-part z)))"
0 0 4 29 1 #"\n"
0 0 17 3 35 #";(put 'add '(complex scheme-number)"
0 0 4 29 1 #"\n"
0 0 17 3 58
#";     (lambda (z x) (tag (add-complex-to-schemenum z x))))"
0 0 4 29 1 #"\n"
0 0 17 3 66
#";; This technique works, but is cumbersome. As the number of types"
0 0 4 29 1 #"\n"
0 0 17 3 69
#";; increase, there is a rapid increase in install costs if cross-type"
0 0 4 29 1 #"\n"
0 0 17 3 67
#";; compatiblity is to be maintained. Also, there is the question of"
0 0 4 29 1 #"\n"
0 0 17 3 68
#";; how to package the procedures appropriately: which package should"
0 0 4 29 1 #"\n"
0 0 17 3 71
(
 #";; have responsibility for which cross-type ops? This method underm"
 #"ines"
) 0 0 4 29 1 #"\n"
0 0 17 3 46 #";; our ability to combine packages additively."
0 0 4 29 1 #"\n"
0 0 17 3 67
#";; In the most general case of completely unrelated types, explicit"
0 0 4 29 1 #"\n"
0 0 17 3 72
(
 #";; cross-type operations are our only option. Luckily, we can usual"
 #"ly do"
) 0 0 4 29 1 #"\n"
0 0 17 3 72
(
 #";; better by taking advantage of additional structure latent in our"
 #" type"
) 0 0 4 29 1 #"\n"
0 0 17 3 10 #";; system."
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 12 #";; Coercion."
0 0 4 29 1 #"\n"
0 0 17 3 12 #";; ---------"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 14 3 9 #"coerce-db"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 3 #"())"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 12 #"put-coercion"
0 0 4 3 1 #" "
0 0 14 3 5 #"type1"
0 0 4 3 1 #" "
0 0 14 3 5 #"type2"
0 0 4 3 1 #" "
0 0 14 3 4 #"proc"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 4 #"set!"
0 0 4 3 1 #" "
0 0 14 3 9 #"coerce-db"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 14 3 5 #"type1"
0 0 4 3 1 #" "
0 0 14 3 5 #"type2"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 4 #"proc"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 9 #"coerce-db"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 12 #"get-coercion"
0 0 4 3 1 #" "
0 0 14 3 5 #"type1"
0 0 4 3 1 #" "
0 0 14 3 5 #"type2"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 4 #"elem"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 6 #"equal?"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 4 #"elem"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 14 3 5 #"type1"
0 0 4 3 1 #" "
0 0 14 3 5 #"type2"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 7 #"matches"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"filter"
0 0 4 3 1 #" "
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 9 #"coerce-db"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"null?"
0 0 4 3 1 #" "
0 0 14 3 7 #"matches"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 20 3 2 #"#f"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 4 #"cdar"
0 0 4 3 1 #" "
0 0 14 3 7 #"matches"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 14 #"coercion-procs"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 9 #"coerce-db"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 17 3 47 #"; coercion-procs returns the table of coercion "
0 0 4 29 1 #"\n"
0 0 17 3 76
(
 #";; procs as a list of entries ((t1 . t2) . op), in case of reimplem"
 #"entation."
) 0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"get-from-type"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"caar"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"get-to-type"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cdar"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 17 #"get-coercion-proc"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"cdr"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 64
#";; Often, the types involved are not completely independent, and"
0 0 4 29 1 #"\n"
0 0 17 3 65
#";; there may be ways in which an object of one type may be viewed"
0 0 4 29 1 #"\n"
0 0 17 3 67
#";; as an object of another type (eg. we can view an ordinary number"
0 0 4 29 1 #"\n"
0 0 17 3 65
#";; as a complex number with imaginary part zero). This process is"
0 0 4 29 1 #"\n"
0 0 17 3 61
#";; called \"coercion\". We can implement this idea by designing"
0 0 4 29 1 #"\n"
0 0 17 3 67
#";; coercion procs which transforms one type of object into another,"
0 0 4 29 1 #"\n"
0 0 17 3 63
#";; and install these procs in a special coercion table, indexed"
0 0 4 29 1 #"\n"
0 0 17 3 64
#";; under the names of the two types. Note that some of the slots"
0 0 4 29 1 #"\n"
0 0 17 3 64
#";; in the table will be empty since it's not possible in general"
0 0 4 29 1 #"\n"
0 0 17 3 46 #";; to convert one arbitrary type into another."
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 22 #"scheme-number->complex"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 27 #"make-complex-from-real-imag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 20 3 1 #"0"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 14 3 12 #"put-coercion"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 13 #"scheme-number"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"complex"
0 0 4 3 1 #" "
0 0 14 3 22 #"scheme-number->complex"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 23 #"rational->scheme-number"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 4 #"let*"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 5 #"ratio"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 5 #"ratio"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"cdr"
0 0 4 3 1 #" "
0 0 14 3 5 #"ratio"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 18 #"make-scheme-number"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"/"
0 0 4 3 1 #" "
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 14 3 5 #"denom"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 14 3 12 #"put-coercion"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 8 #"rational"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 13 #"scheme-number"
0 0 4 3 1 #" "
0 0 14 3 23 #"rational->scheme-number"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 65
#";; Once we have the coercion table set up, we can handle coercion"
0 0 4 29 1 #"\n"
0 0 17 3 66
(
 #";; in a uniform manner by modifying \"apply-generic\": When ask"
 #"ed to"
) 0 0 4 29 1 #"\n"
0 0 17 3 66
#";; perform an op, we first check whether the op is defined for the"
0 0 4 29 1 #"\n"
0 0 17 3 63
#";; types (same as before) - if so, we dispatch to the op in the"
0 0 4 29 1 #"\n"
0 0 17 3 67
#";; operations-and-type table. Otherwise, we attempt coercion. First"
0 0 4 29 1 #"\n"
0 0 17 3 68
#";; (assuming 2 args), we try to coerce the first arg into the second"
0 0 4 29 1 #"\n"
0 0 17 3 68
#";; arg's type. If we can't, we try to coerce the second arg into the"
0 0 4 29 1 #"\n"
0 0 17 3 66
#";; type of the first. If neither can be coerced to the other type,"
0 0 4 29 1 #"\n"
0 0 17 3 14 #";; we give up."
0 0 4 29 1 #"\n"
0 0 17 3 72
(
 #";;-----------------------------------------------------------------"
 #"-----"
) 0 0 4 29 1 #"\n"
0 0 17 3 32 #";; apply-generic - with coercion"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 26 3 1 #"."
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 4 #"let*"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 9 #"type-tags"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"map"
0 0 4 3 1 #" "
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 14 3 4 #"proc"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 14 3 9 #"type-tags"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"err"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 5 #"error"
0 0 4 3 1 #" "
0 0 19 3 27 #"\"No method for these types\""
0 0 4 29 1 #"\n"
0 0 4 3 13 #"             "
0 0 22 3 1 #"("
0 0 14 3 4 #"list"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 14 3 9 #"type-tags"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 14 3 4 #"proc"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 5 #"apply"
0 0 4 3 1 #" "
0 0 14 3 4 #"proc"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"map"
0 0 4 3 1 #" "
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"and"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"="
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"length"
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 20 3 1 #"2"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 17 #"                 "
0 0 22 3 1 #"("
0 0 14 3 3 #"not"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"eq?"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 9 #"type-tags"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cadr"
0 0 4 3 1 #" "
0 0 14 3 9 #"type-tags"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 12 #"            "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 5 #"type1"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 9 #"type-tags"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 18 #"                  "
0 0 22 3 1 #"("
0 0 14 3 5 #"type2"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cadr"
0 0 4 3 1 #" "
0 0 14 3 9 #"type-tags"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 18 #"                  "
0 0 22 3 1 #"("
0 0 14 3 2 #"a1"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 18 #"                  "
0 0 22 3 1 #"("
0 0 14 3 2 #"a2"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cadr"
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 14 #"              "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 6 #"t1->t2"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 12 #"get-coercion"
0 0 4 3 1 #" "
0 0 14 3 5 #"type1"
0 0 4 3 1 #" "
0 0 14 3 5 #"type2"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 20 #"                    "
0 0 22 3 1 #"("
0 0 14 3 6 #"t2->t1"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 12 #"get-coercion"
0 0 4 3 1 #" "
0 0 14 3 5 #"type2"
0 0 4 3 1 #" "
0 0 14 3 5 #"type1"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 16 #"                "
0 0 22 3 1 #"("
0 0 15 3 4 #"cond"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"t1->t2"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"t1->t2"
0 0 4 3 1 #" "
0 0 14 3 2 #"a1"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 2 #"a2"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 22 #"                      "
0 0 22 3 1 #"("
0 0 14 3 6 #"t2->t1"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 14 3 2 #"a1"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"t2->t1"
0 0 4 3 1 #" "
0 0 14 3 2 #"a2"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 22 #"                      "
0 0 22 3 1 #"("
0 0 14 3 4 #"else"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"err"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 12 #"            "
0 0 22 3 1 #"("
0 0 14 3 3 #"err"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 17 3 71
(
 #";;-----------------------------------------------------------------"
 #"----"
) 0 0 4 29 1 #"\n"
0 0 17 3 73
(
 #";; However, there may be cases where our coercion scheme is insuffi"
 #"cient."
) 0 0 4 29 1 #"\n"
0 0 17 3 84
(
 #";; What if neither of the objects to be combined can be converted t"
 #"o the type of the"
) 0 0 4 29 1 #"\n"
0 0 17 3 80
(
 #";; other, but both can be converted to a third type? We may wish to"
 #" exploit this"
) 0 0 4 29 1 #"\n"
0 0 17 3 15 #";; possibility."
0 0 4 29 1 #"\n"
0 0 17 3 81
(
 #";; In order to do this and maintain modularity, we must usually tak"
 #"e advantage of"
) 0 0 4 29 1 #"\n"
0 0 17 3 53 #";; still more structure in the relations among types."
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 24 #";; Heirarchies of Types."
0 0 4 29 1 #"\n"
0 0 17 3 25 #";; ----------------------"
0 0 4 29 1 #"\n"
0 0 17 3 82
(
 #";; Above, we relied on relations between pairs of types, but often "
 #"there is a more"
) 0 0 4 29 1 #"\n"
0 0 17 3 77
(
 #";; \"global\" structure to type relationships. Consider numeric"
 #" types, where we"
) 0 0 4 29 1 #"\n"
0 0 17 3 80
(
 #";; typically have a \"heirarchy of types\", or \"tower\" - "
 #"integers are a subtype of"
) 0 0 4 29 1 #"\n"
0 0 17 3 48 #";; rationals, which are a subtype of reals, etc."
0 0 4 29 1 #"\n"
0 0 17 3 83
(
 #";; When we have a tower structure, we only need to specify how to c"
 #"onvert a type to"
) 0 0 4 29 1 #"\n"
0 0 17 3 83
(
 #";; the supertype immediately above it. Two types can then be combin"
 #"ed by converting"
) 0 0 4 29 1 #"\n"
0 0 17 3 83
(
 #";; them to their common supremum stepwise (in a simple tower, as op"
 #"posed to a tree,"
) 0 0 4 29 1 #"\n"
0 0 17 3 44 #";; one type will be converted to the other)."
0 0 4 29 1 #"\n"
0 0 17 3 85
(
 #";; We can redesign apply-generic to handle this as follows: for eac"
 #"h type in a tower,"
) 0 0 4 29 1 #"\n"
0 0 17 3 84
(
 #";; we supply a \"raise\" proc to convert it to the type above. "
 #"When we wish to combine"
) 0 0 4 29 1 #"\n"
0 0 17 3 83
(
 #";; objects, we successivley raise the lower types until all objects"
 #" are at the same"
) 0 0 4 29 1 #"\n"
0 0 17 3 22 #";; level of the tower."
0 0 4 29 1 #"\n"
0 0 17 3 83
(
 #";; Another advantage of such a tower implementation is that we can "
 #"easily implement"
) 0 0 4 29 1 #"\n"
0 0 17 3 82
(
 #";; the notion that every type inherits all ops defined for its supe"
 #"rtypes. We just"
) 0 0 4 29 1 #"\n"
0 0 17 3 84
(
 #";; modify apply-generic so that if an op isn't defined directly for"
 #" a type, we raise"
) 0 0 4 29 1 #"\n"
0 0 17 3 80
(
 #";; the type and try again. We thus climb the tower searching for th"
 #"e op until we"
) 0 0 4 29 1 #"\n"
0 0 17 3 73
(
 #";; either reach a type for which it's defined, or reach the top and"
 #" fail."
) 0 0 4 29 1 #"\n"
0 0 17 3 85
(
 #";; Another advantage of a tower is that it gives us a simple way to"
 #" \"lower\" an object"
) 0 0 4 29 1 #"\n"
0 0 17 3 75
(
 #";; to the simplest representation (eg. 2+3i + 4-3i --> 6 rather tha"
 #"n 6+0i)."
) 0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 31 #";; Inadequacies of Heirarchies."
0 0 4 29 1 #"\n"
0 0 17 3 31 #";; ----------------------------"
0 0 4 29 1 #"\n"
0 0 17 3 74
(
 #";; In general, relations among types may be more general than a hei"
 #"rarchy."
) 0 0 4 29 1 #"\n"
0 0 17 3 82
(
 #";; Types may have not only multiple subtypes, but multiple supertyp"
 #"es. So the type"
) 0 0 4 29 1 #"\n"
0 0 17 3 54 #";; relations form a graph rather than a chain or tree."
0 0 4 29 1 #"\n"
0 0 17 3 80
(
 #";; The multiple supertypes issue is problematic, since there is no "
 #"unique way to"
) 0 0 4 29 1 #"\n"
0 0 17 3 84
(
 #";; raise a type. If we wish to coerce two types to a common third t"
 #"ype, considerable"
) 0 0 4 29 1 #"\n"
0 0 17 3 29 #";; searching may be required."
0 0 4 29 1 #"\n"
0 0 17 3 79
(
 #";; Dealing with many interrelated types while maintaining modularit"
 #"y in a large"
) 0 0 4 29 1 #"\n"
0 0 17 3 56 #";; system is very difficult, and is an area of research."
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 83
(
 #";; [ex 2.81a] Louis notices (apply-generic op x y) may try to"
 #" coerce x and y to the"
) 0 0 4 29 1 #"\n"
0 0 17 3 81
(
 #";;            each other's type even if they're already of the same"
 #" type. He adds"
) 0 0 4 29 1 #"\n"
0 0 17 3 83
(
 #";;            \"coercion\" procedures to \"convert\" a type"
 #" to itself (just an identity"
) 0 0 4 29 1 #"\n"
0 0 17 3 83
(
 #";;            function). If we now use apply-generic with operands "
 #"of the same type"
) 0 0 4 29 1 #"\n"
0 0 17 3 64
#";;            and an op not defined for that type, what happens?"
0 0 4 29 1 #"\n"
0 0 17 3 85
(
 #";; An infinite loop ensues. When the initial lookup fails, apply-ge"
 #"neric will attempt"
) 0 0 4 29 1 #"\n"
0 0 17 3 82
(
 #";; to coerce the first type to the second, and succeed due to the a"
 #"dded procs. The"
) 0 0 4 29 1 #"\n"
0 0 17 3 85
(
 #";; result will be that apply-generic is called again *with the exac"
 #"t same arguments*."
) 0 0 4 29 1 #"\n"
0 0 17 3 54 #";; Again, it will end up calling itself, ad infinitem."
0 0 4 29 1 #"\n"
0 0 17 3 67
(
 #";; [ex 2.81b] Does apply-generic need to be modified for this"
 #" case?"
) 0 0 4 29 1 #"\n"
0 0 17 3 84
(
 #";; No. apply-generic works fine with args of the same type. If the "
 #"op is defined for"
) 0 0 4 29 1 #"\n"
0 0 17 3 84
(
 #";; that type, the first lookup will find it; if not, both the initi"
 #"al lookup and the"
) 0 0 4 29 1 #"\n"
0 0 17 3 82
(
 #";; checks for coercion procs will fail. The only problem is the was"
 #"ted testing for"
) 0 0 4 29 1 #"\n"
0 0 17 3 18 #";; coercion procs."
0 0 4 29 1 #"\n"
0 0 17 3 85
(
 #";; [ex 2.81c] modify apply-generic so it won't try coercion f"
 #"or args of the same type"
) 0 0 4 29 1 #"\n"
0 0 17 3 19 #";; (see proc above)"
0 0 4 29 1 #"\n"
0 0 17 3 86
(
 #";; [ex 2.82] Show how to generalise apply-generic to handle c"
 #"oercion of multiple args."
) 0 0 4 29 1 #"\n"
0 0 17 3 84
(
 #";;           One strategy is to try to coerce all args to the type "
 #"of the first arg,"
) 0 0 4 29 1 #"\n"
0 0 17 3 86
(
 #";;           then to the type of the second arg, and so on. Give an"
 #" example where this"
) 0 0 4 29 1 #"\n"
0 0 17 3 50 #";;           strategy is not sufficiently general."
0 0 4 29 1 #"\n"
0 0 17 3 84
(
 #";; If the args are of types (a,b,c) there may be an op for types (a"
 #",b,b) but not for"
) 0 0 4 29 1 #"\n"
0 0 17 3 84
(
 #";; (a,a,a) or (b,b,b). There's also a chance that two types can bot"
 #"h be converted to"
) 0 0 4 29 1 #"\n"
0 0 17 3 85
(
 #";; a third type for which an appropriate op may exist (this applies"
 #" to the 2-arg case"
) 0 0 4 29 1 #"\n"
0 0 17 3 12 #";; as well)."
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 14 #"coercion-from?"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 6 #"equal?"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"caar"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 12 #"coercion-to?"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 6 #"equal?"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cdar"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 12 #"coerce-image"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 3 #"cdb"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 14 #"coercion-procs"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 14 #"coercion-from?"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 3 #"map"
0 0 4 3 1 #" "
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"filter"
0 0 4 3 1 #" "
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 3 #"cdb"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 16 #"generic-preimage"
0 0 4 3 1 #" "
0 0 14 3 4 #"name"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 3 #"gdb"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"generic-procs"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"equal?"
0 0 4 3 1 #" "
0 0 14 3 4 #"name"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"get-name"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 3 #"map"
0 0 4 3 1 #" "
0 0 14 3 8 #"get-type"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"filter"
0 0 4 3 1 #" "
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 3 #"gdb"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"find-coercion"
0 0 4 3 1 #" "
0 0 14 3 4 #"from"
0 0 4 3 1 #" "
0 0 14 3 2 #"to"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 17 3 32 #"; type type -> coercion-db entry"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"eq?"
0 0 4 3 1 #" "
0 0 14 3 4 #"from"
0 0 4 3 1 #" "
0 0 14 3 2 #"to"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 14 3 4 #"from"
0 0 4 3 1 #" "
0 0 14 3 2 #"to"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 2 #"id"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 3 #"cdb"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 14 #"coercion-procs"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"and"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 14 #"coercion-from?"
0 0 4 3 1 #" "
0 0 14 3 4 #"from"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 12 #"coercion-to?"
0 0 4 3 1 #" "
0 0 14 3 2 #"to"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 7 #"success"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 6 #"filter"
0 0 4 3 1 #" "
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 3 #"cdb"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"null?"
0 0 4 3 1 #" "
0 0 14 3 7 #"success"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 4 29 1 #"\n"
0 0 4 3 10 #"          "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 7 #"success"
0 0 22 3 6 #"))))))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"coercion-list"
0 0 4 3 1 #" "
0 0 14 3 7 #"to-type"
0 0 4 3 1 #" "
0 0 14 3 8 #"typelist"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"map"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"type"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 5 #"entry"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"find-coercion"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 4 3 1 #" "
0 0 14 3 7 #"to-type"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 11 #"           "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 4 29 1 #"\n"
0 0 4 3 15 #"               "
0 0 22 3 1 #"("
0 0 14 3 3 #"cdr"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 15 #"               "
0 0 20 3 2 #"#f"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 14 3 8 #"typelist"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 15 #"convert-to-type"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 4 3 1 #" "
0 0 14 3 7 #"arglist"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 4 #"let*"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 8 #"typelist"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"map"
0 0 4 3 1 #" "
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 7 #"arglist"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 14 3 10 #"coercelist"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"coercion-list"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 4 3 1 #" "
0 0 14 3 8 #"typelist"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 3 #"map"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"proc"
0 0 4 3 1 #" "
0 0 14 3 3 #"val"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 11 #"           "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 14 3 4 #"proc"
0 0 4 29 1 #"\n"
0 0 4 3 15 #"               "
0 0 22 3 1 #"("
0 0 14 3 4 #"proc"
0 0 4 3 1 #" "
0 0 14 3 3 #"val"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 15 #"               "
0 0 20 3 2 #"#f"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 14 3 10 #"coercelist"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 14 3 7 #"arglist"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"unify-types"
0 0 4 3 1 #" "
0 0 14 3 7 #"arglist"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 14 3 4 #"iter"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 12 #"types-to-try"
0 0 4 3 1 #" "
0 0 14 3 7 #"arglist"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 15 3 4 #"cond"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 5 #"null?"
0 0 4 3 1 #" "
0 0 14 3 12 #"types-to-try"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 10 #"          "
0 0 22 3 2 #"(("
0 0 14 3 3 #"not"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"pair?"
0 0 4 3 1 #" "
0 0 14 3 12 #"types-to-try"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"error"
0 0 4 3 1 #" "
0 0 19 3 41 #"\"UNIFY-TYPES: arg must be a proper list \""
0 0 4 3 1 #" "
0 0 14 3 7 #"arglist"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 10 #"          "
0 0 22 3 1 #"("
0 0 14 3 4 #"else"
0 0 4 29 1 #"\n"
0 0 4 3 11 #"           "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 11 #"target-type"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 12 #"types-to-try"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 17 #"                 "
0 0 22 3 1 #"("
0 0 14 3 4 #"rest"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"cdr"
0 0 4 3 1 #" "
0 0 14 3 12 #"types-to-try"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 13 #"             "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 6 #"result"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 15 #"convert-to-type"
0 0 4 3 1 #" "
0 0 14 3 11 #"target-type"
0 0 4 3 1 #" "
0 0 14 3 7 #"arglist"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 15 #"               "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"nofails?"
0 0 4 3 1 #" "
0 0 14 3 6 #"result"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 19 #"                   "
0 0 14 3 6 #"result"
0 0 4 29 1 #"\n"
0 0 4 3 19 #"                   "
0 0 22 3 1 #"("
0 0 14 3 4 #"iter"
0 0 4 3 1 #" "
0 0 14 3 4 #"rest"
0 0 22 3 8 #"))))))))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"nofails?"
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"not"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"memq"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 4 3 1 #" "
0 0 14 3 2 #"ls"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 48 #";; apply-generic with coercion for multiple args"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 15 #"apply-generic-2"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 26 3 1 #"."
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 4 #"let*"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 9 #"type-tags"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"map"
0 0 4 3 1 #" "
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 14 3 4 #"proc"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 14 3 9 #"type-tags"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"err"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 5 #"error"
0 0 4 3 1 #" "
0 0 19 3 27 #"\"No method for these types\""
0 0 4 29 1 #"\n"
0 0 4 3 13 #"             "
0 0 22 3 1 #"("
0 0 14 3 4 #"list"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 14 3 9 #"type-tags"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 14 3 4 #"proc"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 5 #"apply"
0 0 4 3 1 #" "
0 0 14 3 4 #"proc"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"map"
0 0 4 3 1 #" "
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 14 #"converted-args"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"unify-types"
0 0 4 3 1 #" "
0 0 14 3 4 #"args"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 10 #"          "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 14 3 14 #"converted-args"
0 0 4 29 1 #"\n"
0 0 4 3 14 #"              "
0 0 22 3 1 #"("
0 0 14 3 5 #"apply"
0 0 4 3 1 #" "
0 0 14 3 13 #"apply-generic"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"cons"
0 0 4 3 1 #" "
0 0 14 3 2 #"op"
0 0 4 3 1 #" "
0 0 14 3 14 #"converted-args"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 14 #"              "
0 0 22 3 1 #"("
0 0 14 3 3 #"err"
0 0 22 3 6 #"))))))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 87
(
 #";; [ex 2.83] Suppose you're designing a generic arithmetic sy"
 #"stem for the numeric tower"
) 0 0 4 29 1 #"\n"
0 0 17 3 45 #";;           (integer rational real complex)."
0 0 4 29 1 #"\n"
0 0 17 3 95
(
 #";;           For each type (except complex), design a \"raise\""
 #" proc that raises an object to the"
) 0 0 4 29 1 #"\n"
0 0 17 3 33 #";;             next higher level."
0 0 4 29 1 #"\n"
0 0 17 3 97
(
 #";;           Show how to install a generic raise op that will work "
 #"for each type (except complex)"
) 0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 18 #";; integer-package"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 23 #"install-integer-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 17 3 17 #";; internal procs"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"attach-tag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"integer"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"add"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"integer"
0 0 4 3 1 #" "
0 0 14 3 7 #"integer"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"+"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"mul"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"integer"
0 0 4 3 1 #" "
0 0 14 3 7 #"integer"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"sub"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"integer"
0 0 4 3 1 #" "
0 0 14 3 7 #"integer"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"-"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"div"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"integer"
0 0 4 3 1 #" "
0 0 14 3 7 #"integer"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"truncate"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"/"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 6 #"))))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 4 #"make"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"integer"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 20 3 1 #"'"
0 0 14 3 4 #"done"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 17 3 14 #";; constructor"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 12 #"make-integer"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"attach-tag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"integer"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 15 #";; real-package"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 20 #"install-real-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 17 3 17 #";; internal procs"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"attach-tag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 4 #"real"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"add"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 4 #"real"
0 0 4 3 1 #" "
0 0 14 3 4 #"real"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"+"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"mul"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 4 #"real"
0 0 4 3 1 #" "
0 0 14 3 4 #"real"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"*"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"sub"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 4 #"real"
0 0 4 3 1 #" "
0 0 14 3 4 #"real"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"-"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"div"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 4 #"real"
0 0 4 3 1 #" "
0 0 14 3 4 #"real"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 7 #"       "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"/"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"m"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 4 #"make"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 4 #"real"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"tag"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 20 3 1 #"'"
0 0 14 3 4 #"done"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 17 3 14 #";; constructor"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"make-real"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 10 #"attach-tag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 4 #"real"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 17 #"integer->rational"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 13 #"make-rational"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 20 3 1 #"1"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 14 #"rational->real"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 4 #"let*"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 5 #"ratio"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"car"
0 0 4 3 1 #" "
0 0 14 3 5 #"ratio"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 14 3 5 #"denom"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"cdr"
0 0 4 3 1 #" "
0 0 14 3 5 #"ratio"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 9 #"make-real"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"/"
0 0 4 3 1 #" "
0 0 14 3 5 #"numer"
0 0 4 3 1 #" "
0 0 14 3 5 #"denom"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"real->complex"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 27 #"make-complex-from-real-imag"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"contents"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 20 3 1 #"0"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"raise"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"integer"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 17 #"integer->rational"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"raise"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 8 #"rational"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 14 #"rational->real"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"raise"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 4 #"real"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 13 #"real->complex"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"raise"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"type"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"raise"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 15 #"genproc-exists?"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"raise"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 4 #"proc"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"get"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 5 #"raise"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"list"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 5 #")))))"
0 0 4 29 1 #"\n"
0 0 4 3 8 #"        "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 14 3 4 #"proc"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"proc"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 20 3 2 #"#f"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 15 #"genproc-exists?"
0 0 4 3 1 #" "
0 0 14 3 4 #"name"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"pred"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 3 #"and"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"eq?"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"get-name"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 4 #"name"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 9 #"         "
0 0 22 3 1 #"("
0 0 14 3 3 #"eq?"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"get-type"
0 0 4 3 1 #" "
0 0 14 3 5 #"entry"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 5 #"foldr"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"a"
0 0 4 3 1 #" "
0 0 14 3 1 #"b"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 2 #"or"
0 0 4 3 1 #" "
0 0 14 3 1 #"a"
0 0 4 3 1 #" "
0 0 14 3 1 #"b"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"generic-procs"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 12 #";; [ex 2.84]"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"numeric?"
0 0 4 3 1 #" "
0 0 14 3 3 #"val"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 4 #"type"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 3 #"val"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 4 #"inq?"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 4 29 1 #"\n"
0 0 4 3 10 #"          "
0 0 22 3 1 #"("
0 0 14 3 4 #"list"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 13 #"scheme-number"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 8 #"rational"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 4 #"real"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"complex"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 2 #"de"
0 0 15 3 4 #"fine"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"type>"
0 0 4 3 1 #" "
0 0 14 3 5 #"type1"
0 0 4 3 1 #" "
0 0 14 3 5 #"type2"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"raise-to"
0 0 4 3 1 #" "
0 0 14 3 5 #"type2"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 5 #"type1"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 20 3 2 #"#t"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"raise-to"
0 0 4 3 1 #" "
0 0 14 3 3 #"val"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"iter"
0 0 4 3 1 #" "
0 0 14 3 1 #"v"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"eq?"
0 0 4 3 1 #" "
0 0 14 3 1 #"v"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 20 3 2 #"#f"
0 0 4 29 1 #"\n"
0 0 4 3 4 #"    "
0 0 22 3 1 #"("
0 0 15 3 3 #"let"
0 0 4 3 1 #" "
0 0 22 3 2 #"(("
0 0 14 3 1 #"t"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 8 #"type-tag"
0 0 4 3 1 #" "
0 0 14 3 1 #"v"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 7 #"display"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"list"
0 0 4 3 1 #" "
0 0 14 3 1 #"v"
0 0 4 3 1 #" "
0 0 14 3 1 #"t"
0 0 22 3 2 #"))"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 7 #"newline"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 6 #"      "
0 0 22 3 1 #"("
0 0 14 3 2 #"if"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"eq?"
0 0 4 3 1 #" "
0 0 14 3 1 #"t"
0 0 4 3 1 #" "
0 0 14 3 4 #"type"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 10 #"          "
0 0 14 3 1 #"v"
0 0 4 29 1 #"\n"
0 0 4 3 10 #"          "
0 0 22 3 1 #"("
0 0 14 3 4 #"iter"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 5 #"raise"
0 0 4 3 1 #" "
0 0 14 3 1 #"v"
0 0 22 3 6 #"))))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 4 #"iter"
0 0 4 3 1 #" "
0 0 14 3 3 #"val"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 14 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 4 29 1 #"\n"
0 0 17 3 25 #";; ======================"
0 0 4 29 1 #"\n"
0 0 17 3 25 #";; TESTING SESSION SETUP."
0 0 4 29 1 #"\n"
0 0 17 3 25 #";; ======================"
0 0 4 29 1 #"\n"
0 0 4 3 1 #" "
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 11 #"testsession"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 27 #"install-rectangular-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 21 #"install-polar-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 23 #"install-complex-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 29 #"install-scheme-number-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 24 #"install-rational-package"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 3 #"pow"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 13 #"scheme-number"
0 0 4 3 1 #" "
0 0 14 3 13 #"scheme-number"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"expt"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"minimag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 7 #"complex"
0 0 4 3 1 #" "
0 0 14 3 7 #"complex"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"min"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"magnitude"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 4 #"))))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 22 3 1 #"("
0 0 14 3 3 #"put"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 14 3 7 #"minimag"
0 0 4 3 1 #" "
0 0 20 3 1 #"'"
0 0 22 3 1 #"("
0 0 14 3 12 #"sceme-number"
0 0 4 3 1 #" "
0 0 14 3 13 #"scheme-number"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 15 3 6 #"lambda"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 1 #")"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 3 #"min"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"y"
0 0 22 3 3 #")))"
0 0 4 29 1 #"\n"
0 0 4 3 2 #"  "
0 0 20 3 1 #"'"
0 0 14 3 4 #"done"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 14 3 9 #"mkcomplex"
0 0 4 3 1 #" "
0 0 14 3 27 #"make-complex-from-real-imag"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 17 3 22 #";; start testsession.."
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 14 3 11 #"testsession"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 14 3 1 #"c"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"mkcomplex"
0 0 4 3 1 #" "
0 0 20 3 1 #"3"
0 0 4 3 1 #" "
0 0 20 3 1 #"1"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 14 3 1 #"d"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 9 #"mkcomplex"
0 0 4 3 1 #" "
0 0 20 3 1 #"4"
0 0 4 3 1 #" "
0 0 20 3 1 #"2"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 20 3 1 #"7"
0 0 22 3 1 #")"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 13 #"make-rational"
0 0 4 3 1 #" "
0 0 20 3 1 #"3"
0 0 4 3 1 #" "
0 0 20 3 1 #"5"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 14 3 2 #"ll"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"list"
0 0 4 3 1 #" "
0 0 14 3 1 #"c"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"d"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 14 3 1 #"l"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 4 #"list"
0 0 4 3 1 #" "
0 0 14 3 1 #"c"
0 0 4 3 1 #" "
0 0 14 3 1 #"x"
0 0 4 3 1 #" "
0 0 14 3 1 #"d"
0 0 4 3 1 #" "
0 0 14 3 1 #"r"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 0 22 3 1 #"("
0 0 15 3 6 #"define"
0 0 4 3 1 #" "
0 0 14 3 1 #"n"
0 0 4 3 1 #" "
0 0 22 3 1 #"("
0 0 14 3 12 #"make-integer"
0 0 4 3 1 #" "
0 0 20 3 1 #"8"
0 0 22 3 2 #"))"
0 0 4 29 1 #"\n"
0 00000000000
